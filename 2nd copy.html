<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional PDF Flipbook</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';</script>
    
    <link rel="stylesheet" href="style.css">
    <style>
      /* --- Reset & Base --- */


.flipbook-viewport {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin: 0;
    background: #525659;
    overflow: hidden;
}

/* --- Scene & Book Layout --- */
.scene-container {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    padding: 20px;
    position: relative;
}

.scene {
    width: 100%;
    max-width: 900px;
    aspect-ratio: 3 / 2;
    perspective: 2500px;
    transition: transform 0.3s ease;
}

.book {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1);
}

/* ðŸŸ¢ When Closed: Shift Left to center the cover */
.book.closed {
    transform: translateX(-25%);
}

/* --- Page Styling --- */
.page {
    position: absolute;
    width: 50%;
    height: 100%;
    left: 50%;
    background: #fff;
    transform-origin: left center;
    transform-style: preserve-3d;
    transition: transform 0.9s cubic-bezier(0.645, 0.045, 0.355, 1);
    border-left: 1px solid rgba(0,0,0,0.1); /* Spine line */
}

.front, .back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    background-color: #fff;
    overflow: hidden;
}

.front {
    z-index: 2;
    transform: rotateY(0deg);
}

/* Realistic Page Shadow */
.front::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(to right, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 15%);
    pointer-events: none;
}

.back {
    transform: rotateY(180deg);
    z-index: 1;
    background-color: #fdfdfd;
}

.back::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(to left, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 15%);
    pointer-events: none;
}

/* Page Flip Action */
.page.flipped {
    transform: rotateY(-180deg);
}

canvas {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

/* --- Navigation Buttons --- */
.flip-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(5px);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    cursor: pointer;
    z-index: 2000;
    border: 1px solid rgba(255,255,255,0.2);
    transition: all 0.3s;
}

.flip-nav:hover {
    background: white;
    color: #333;
    box-shadow: 0 0 15px rgba(255,255,255,0.3);
}

#prev { left: 20px; }
#next { right: 20px; }

/* --- Toolbar --- */
.toolbar {
    margin-bottom: 20px;
    height: 50px;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    border-radius: 30px;
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 0 25px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: white;
    z-index: 5000;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.page-count { font-size: 14px; font-weight: 500; color: #ddd; }
.divider { width: 1px; height: 20px; background: rgba(255,255,255,0.2); }

.tool-btn {
    background: none; border: none; color: #ccc;
    font-size: 18px; cursor: pointer; padding: 8px;
    transition: 0.2s;
}
.tool-btn:hover { color: white; transform: scale(1.1); }

/* --- Responsive --- */
@media (max-width: 768px) {
    .scene { width: 95%; }
    .flip-nav { width: 40px; height: 40px; font-size: 16px; }
    #prev { left: 10px; } 
    #next { right: 10px; }
    .book.closed { transform: translateX(-25%); } /* Keep centering on mobile */
}
    </style>
</head>
<body>

    <div class="flipbook-viewport">
        <div class="scene-container">
            <div id="prev" class="flip-nav"><i class="fas fa-chevron-left"></i></div>
            <div id="next" class="flip-nav"><i class="fas fa-chevron-right"></i></div>

            <div class="scene" id="scene">
                <div class="book" id="book">
                    </div>
            </div>
        </div>

        <div class="toolbar">
            <div class="page-count" id="page-counter">Loading PDF...</div>
            <div class="divider"></div>
            <button class="tool-btn" id="zoom-in" title="Zoom In"><i class="fas fa-search-plus"></i></button>
            <button class="tool-btn" id="zoom-out" title="Zoom Out"><i class="fas fa-search-minus"></i></button>
            <div class="divider"></div>
            <button class="tool-btn" id="fullscreen-btn" title="Fullscreen"><i class="fas fa-expand"></i></button>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
      // --- Configuration ---
const pdfUrl = "assets/book.pdf"; // à¦à¦–à¦¾à¦¨à§‡ à¦†à¦ªà¦¨à¦¾à¦° PDF à¦«à¦¾à¦‡à¦²à§‡à¦° à¦¨à¦¾à¦® à¦¦à¦¿à¦¨
const book = document.getElementById("book");
const scene = document.getElementById("scene");
const pageCounter = document.getElementById("page-counter");

let pages = [];
let currentPageIndex = 0;
let totalPdfPages = 0;
let currentScale = 1;

// --- Load PDF ---
pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
    totalPdfPages = pdf.numPages;
    
    // Create Sheets (1 Sheet = 2 Pages)
    for (let i = 1; i <= totalPdfPages; i += 2) {
        createSheet(pdf, i, i + 1);
    }

    // ðŸŸ¢ Initial State: Closed & Centered
    if (currentPageIndex === 0) {
        book.classList.add("closed");
    }

    updateUI();
    resizeBook();
}).catch(err => {
    console.error(err);
    pageCounter.innerText = "PDF Load Error";
});

// --- Responsive Resize ---
window.addEventListener('resize', resizeBook);

function resizeBook() {
    const containerWidth = document.querySelector('.scene-container').clientWidth;
    const baseWidth = containerWidth > 900 ? 900 : containerWidth - 30;
    scene.style.width = `${baseWidth}px`;
}

// --- Sheet Creation Logic ---
function createSheet(pdf, p1, p2) {
    const sheet = document.createElement("div");
    sheet.className = "page";
    sheet.style.zIndex = 1000 - pages.length; // Stack order

    const front = document.createElement("div");
    front.className = "front";
    const back = document.createElement("div");
    back.className = "back";

    sheet.appendChild(front);
    sheet.appendChild(back);
    book.appendChild(sheet);
    pages.push(sheet);

    // Render Pages
    renderPage(pdf, p1, front);
    if (p2 <= totalPdfPages) {
        renderPage(pdf, p2, back);
    } else {
        back.style.background = "#fff"; // Empty back page
    }
}

function renderPage(pdf, pageNo, container) {
    pdf.getPage(pageNo).then(page => {
        const viewport = page.getViewport({ scale: 2 }); // Scale 2 for better quality
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = viewport.width;
        canvas.height = viewport.height;
        container.appendChild(canvas);
        page.render({ canvasContext: ctx, viewport: viewport });
    });
}

// --- Navigation Logic (Next/Prev) ---
function goNext() {
    if (currentPageIndex < pages.length) {
        const currentSheet = pages[currentPageIndex];
        currentSheet.classList.add("flipped");
        currentSheet.style.zIndex = 1000 + currentPageIndex; // Bring to top stack
        currentPageIndex++;
        updateUI();
    }
}

function goPrev() {
    if (currentPageIndex > 0) {
        currentPageIndex--;
        const currentSheet = pages[currentPageIndex];
        currentSheet.classList.remove("flipped");
        
        // Wait for animation to finish before resetting z-index
        setTimeout(() => {
            currentSheet.style.zIndex = 1000 - currentPageIndex;
        }, 300); // Matches CSS transition time roughly
        
        updateUI();
    }
}

document.getElementById("next").onclick = goNext;
document.getElementById("prev").onclick = goPrev;

// --- ðŸŸ¢ Mobile Swipe Support ---
let touchStartX = 0;
let touchEndX = 0;

scene.addEventListener('touchstart', e => touchStartX = e.changedTouches[0].screenX);
scene.addEventListener('touchend', e => {
    touchEndX = e.changedTouches[0].screenX;
    if (touchEndX < touchStartX - 50) goNext(); // Swipe Left
    if (touchEndX > touchStartX + 50) goPrev(); // Swipe Right
});

// --- UI Updates & Centering Logic ---
function updateUI() {
    // ðŸŸ¢ Smart Centering Logic
    if (currentPageIndex === 0) {
        book.classList.add("closed"); // Center the cover
    } else {
        book.classList.remove("closed"); // Shift right for open book
    }

    // Button Visibility
    document.getElementById("prev").style.opacity = currentPageIndex === 0 ? '0' : '1';
    document.getElementById("prev").style.pointerEvents = currentPageIndex === 0 ? 'none' : 'auto';
    
    document.getElementById("next").style.opacity = currentPageIndex === pages.length ? '0' : '1';
    document.getElementById("next").style.pointerEvents = currentPageIndex === pages.length ? 'none' : 'auto';

    // Page Counter Text
    let leftPage = currentPageIndex * 2;
    let rightPage = leftPage + 1;
    let text = "";
    
    if (currentPageIndex === 0) text = `Cover`;
    else if (rightPage > totalPdfPages) text = `Page ${leftPage} / ${totalPdfPages}`;
    else text = `Pages ${leftPage}-${rightPage}`;
    
    pageCounter.innerText = text;
}

// --- Toolbar Controls ---
document.getElementById("zoom-in").onclick = () => {
    if (currentScale < 1.8) { currentScale += 0.2; applyZoom(); }
};
document.getElementById("zoom-out").onclick = () => {
    if (currentScale > 0.6) { currentScale -= 0.2; applyZoom(); }
};
function applyZoom() { scene.style.transform = `scale(${currentScale})`; }

document.getElementById("fullscreen-btn").onclick = () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        if (document.exitFullscreen) document.exitFullscreen();
    }
};
    </script>
</body>
</html>